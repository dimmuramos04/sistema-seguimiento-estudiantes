{% extends "base.html" %}

{% block title %}Crear Nuevo Usuario{% endblock %}

{% block content %}
    <h1>Crear Nuevo Usuario</h1>

    {# Mostrar mensajes flash #}
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category | default('info') }}" role="alert">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <form method="POST" action="{{ url_for('crear_usuario') }}">
        <div class="form-group">
            <label for="username">Nombre de Usuario (para login):</label>
            <input type="text" id="username" name="username" value="{{ username if username else '' }}" required>
        </div>

        <div class="form-group">
            <label for="password">Contraseña:</label>
            <input type="password" id="password" name="password" required>
        </div>

        <div class="form-group">
            <label for="confirm_password">Confirmar Contraseña:</label>
            <input type="password" id="confirm_password" name="confirm_password" required>
        </div>

        <div class="form-group">
            <label for="nombre_completo">Nombre Completo (para mostrar):</label>
            <input type="text" id="nombre_completo" name="nombre_completo" value="{{ nombre_completo if nombre_completo else '' }}">
        </div>

        <div class="form-group">
            <label for="rol">Rol del Usuario:</label>
            <select id="rol" name="rol" required>
                <option value="">Seleccione un rol...</option>
                {% for rol_opcion in lista_roles %}
                <option value="{{ rol_opcion }}" {% if rol_seleccionado == rol_opcion %}selected{% endif %}>{{ rol_opcion | capitalize }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <input type="checkbox" id="activo" name="activo" value="1" {% if activo_check or activo_check is not defined %}checked{% endif %}> {# Marcado por defecto o si es true #}
            <label for="activo" style="font-weight: normal; display: inline;">Usuario Activo</label>
        </div>
        
        <div class="form-group" style="margin-top: 20px; display: flex; gap: 10px;"> {# Añadido display:flex y gap #}
            {# Botón Crear Usuario ahora usa button-primary #}
            <input type="submit" value="Crear Usuario" class="button button-primary">
            {# Botón Cancelar ahora usa button-secondary #}
            <a href="{{ url_for('admin_listar_usuarios') }}" class="button button-secondary">Cancelar</a>
        </div>
    </form>
{% endblock %}